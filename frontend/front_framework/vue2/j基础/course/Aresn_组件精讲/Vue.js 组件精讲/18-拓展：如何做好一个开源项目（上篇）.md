# Vue 自定义指令实现点击元素外触发事件

> 前言 最近写项目需要实现一个场景，点击一块区域，弹出一个编辑区域，点击页面的其他地方的时候，这个编辑区域就隐藏，本想想之前写模态框一样写个方法是，觉得可以尝试用 vue 相关的东西优雅的解决这个问题。



## 1 - 前置知识

我们直接来看官方文档。

### 1.1 定义

出了核心功能默认内置的指令（`v-model` 和 `v-show`），Vue 也允许注册自定义指令。注意，在 Vue2.0 中，代码复用和抽象的主要形式是组件。然而，有的情况下，你仍然需要对普通的 DOM 元素进行底层操作，这时候就会用到自定义指令。

### 1.2 基础实现

这个分两种情况

- 如果你想定义一个全局的自定义组件的话，那么就在项目中的 `mian.js` 里面定义了，官网自动聚焦的例子：

  ```js
  // 注册一个全局自定义指令 `v-focus`
  Vue.directive(`focus` {
    // 当被绑定的元素插入到 DOM 中时
    inserted: function (el) {
      // 聚焦元素
      el.focus()
    }
  })
  ```

- 如果你只是想定义一个局部的指令在某个组件内部中使用的话，就要在相应的组件内定义了

  ```js
  // 跟 data (), methods: {} 那些同级写了
  directives: {
    focus: {
      // 指令的定义
      inserted: function (el) {
        el.focus()
      }
    }
  }
  ```

定义完之后我们就可以立即食用了：

```vue
<input v-foucs>
```

### 1.3 钩子函数

当然这个自定义指令不会只有这么一点点东西，为了解决一些现实中的场景，Vue 给我们的一堆钩子函数用来实现我们的一些骚操作，具体如下（均为可选）：

- `bind`：只调用一次，指令第一次绑定到元素时调用。在这里可以进行一次性的初始化设置